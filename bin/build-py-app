#!/bin/bash

cat >build.sh <<EOF
#!/bin/sh
virtualenv target
source target/bin/activate
pip install --no-cache-dir -r requirements.txt
EOF

# make it executable
chmod +x build.sh

# pull and build python app dependency
docker run -it --rm -v ${PWD}:/app -v ${PWD}/build.sh:/build.sh -w /app \
    python:2.7 \
    /build.sh

# clean up after ourselves
rm -f build.sh
